# ReconHunter - 终极自动化漏洞扫描框架

## 产品定位

**一站式Bug Bounty自动化工具** - 从信息收集到漏洞利用，全流程自动化

---

## 竞品分析与超越

### 现有工具的问题

| 工具 | 优点 | 缺点 |
|------|------|------|
| Nuclei | 模板丰富、速度快 | 只做漏洞扫描，无信息收集 |
| Subfinder | 子域名收集全 | 单一功能 |
| httpx | 快速探测 | 单一功能 |
| Amass | 信息收集强 | 太慢、配置复杂 |
| Burp Suite | 功能全面 | 贵、需手动操作 |
| Acunetix | 企业级扫描 | 极贵、不灵活 |
| ProjectDiscovery套件 | 工具多 | 需要自己组合、写脚本 |

### ReconHunter的优势

```
1. 全流程自动化 - 一个命令完成所有
2. 智能调度 - 根据目标自动选择策略
3. 去重 & 关联 - 智能合并结果
4. 实时通知 - Webhook/Discord/Telegram
5. 持续监控 - 定时扫描、变化检测
6. 漂亮报告 - 专业PDF/HTML报告
7. Web界面 - 可视化管理
8. 插件系统 - 可扩展
```

---

## 核心功能模块

### Phase 1: 资产发现 (Asset Discovery)

```
┌─────────────────────────────────────────────────────┐
│                   资产发现模块                        │
├─────────────────────────────────────────────────────┤
│                                                     │
│  [子域名枚举]                                        │
│  ├── 被动收集                                        │
│  │   ├── Certificate Transparency (crt.sh)         │
│  │   ├── SecurityTrails API                        │
│  │   ├── VirusTotal                                │
│  │   ├── Shodan                                    │
│  │   ├── Censys                                    │
│  │   ├── AlienVault OTX                            │
│  │   ├── HackerTarget                              │
│  │   ├── ThreatCrowd                               │
│  │   ├── DNSDumpster                               │
│  │   ├── Wayback Machine                           │
│  │   └── Common Crawl                              │
│  │                                                  │
│  └── 主动枚举                                        │
│      ├── DNS爆破 (自定义字典)                         │
│      ├── 排列组合生成                                 │
│      ├── DNS区域传送尝试                              │
│      └── 虚拟主机枚举                                 │
│                                                     │
│  [端口扫描]                                          │
│  ├── Masscan (超快速扫描)                            │
│  ├── Nmap (精细扫描)                                 │
│  ├── 服务识别                                        │
│  └── 版本检测                                        │
│                                                     │
│  [Web探测]                                           │
│  ├── HTTP/HTTPS探活                                  │
│  ├── 状态码检测                                      │
│  ├── 标题提取                                        │
│  ├── 技术栈识别 (Wappalyzer)                         │
│  ├── WAF检测                                        │
│  ├── CDN检测                                        │
│  └── 截图                                           │
│                                                     │
│  [JS分析]                                            │
│  ├── JS文件发现                                      │
│  ├── 端点提取                                        │
│  ├── 密钥/Token提取                                  │
│  ├── 敏感信息检测                                    │
│  └── Source Map分析                                  │
│                                                     │
│  [目录扫描]                                          │
│  ├── 常见路径爆破                                    │
│  ├── 备份文件检测                                    │
│  ├── Git泄露检测                                    │
│  ├── SVN泄露检测                                    │
│  ├── 敏感文件检测                                    │
│  └── API路径发现                                    │
│                                                     │
│  [参数发现]                                          │
│  ├── 历史参数挖掘 (Wayback)                          │
│  ├── 参数爆破                                        │
│  ├── 隐藏参数检测                                    │
│  └── 参数类型推断                                    │
│                                                     │
└─────────────────────────────────────────────────────┘
```

### Phase 2: 漏洞扫描 (Vulnerability Scanning)

```
┌─────────────────────────────────────────────────────┐
│                   漏洞扫描模块                        │
├─────────────────────────────────────────────────────┤
│                                                     │
│  [注入类漏洞]                                        │
│  ├── SQL注入                                        │
│  │   ├── Error-based                               │
│  │   ├── Time-based blind                          │
│  │   ├── Boolean-based blind                       │
│  │   ├── Union-based                               │
│  │   └── Out-of-band                               │
│  ├── NoSQL注入                                      │
│  ├── LDAP注入                                       │
│  ├── XPath注入                                      │
│  └── 模板注入 (SSTI)                                 │
│                                                     │
│  [XSS]                                              │
│  ├── 反射型XSS                                      │
│  ├── 存储型XSS探测                                   │
│  ├── DOM XSS                                        │
│  ├── Payload生成器                                  │
│  └── CSP绕过检测                                    │
│                                                     │
│  [命令注入]                                          │
│  ├── OS命令注入                                     │
│  ├── 代码注入                                       │
│  └── 表达式注入                                     │
│                                                     │
│  [SSRF]                                             │
│  ├── 基础SSRF检测                                   │
│  ├── 云元数据访问                                   │
│  ├── 内网探测                                       │
│  └── 协议走私                                       │
│                                                     │
│  [文件相关]                                          │
│  ├── 任意文件读取 (LFI)                              │
│  ├── 任意文件包含 (RFI)                              │
│  ├── 任意文件上传                                   │
│  ├── 路径穿越                                       │
│  └── XXE注入                                        │
│                                                     │
│  [认证授权]                                          │
│  ├── IDOR检测                                       │
│  ├── 水平越权                                       │
│  ├── 垂直越权                                       │
│  ├── JWT漏洞                                        │
│  │   ├── 算法混淆                                   │
│  │   ├── 密钥爆破                                   │
│  │   └── 签名绕过                                   │
│  ├── OAuth漏洞                                      │
│  └── Session管理漏洞                                │
│                                                     │
│  [配置错误]                                          │
│  ├── CORS配置错误                                   │
│  ├── 安全头缺失                                     │
│  ├── CRLF注入                                       │
│  ├── 开放重定向                                     │
│  ├── 信息泄露                                       │
│  └── Debug模式开启                                  │
│                                                     │
│  [HTTP相关]                                          │
│  ├── HTTP请求走私                                   │
│  ├── 缓存投毒                                       │
│  ├── Host头攻击                                     │
│  └── HTTP方法篡改                                   │
│                                                     │
│  [API安全]                                           │
│  ├── GraphQL漏洞                                    │
│  │   ├── 内省泄露                                   │
│  │   ├── 深度攻击                                   │
│  │   └── 批量查询                                   │
│  ├── REST API漏洞                                   │
│  ├── 速率限制绕过                                   │
│  └── 版本探测                                       │
│                                                     │
│  [CVE扫描]                                           │
│  ├── 已知CVE检测                                    │
│  ├── Nuclei模板集成                                 │
│  ├── 自定义PoC                                      │
│  └── 0day指纹库                                     │
│                                                     │
│  [云安全]                                            │
│  ├── AWS配置错误                                    │
│  │   ├── S3桶公开                                   │
│  │   ├── 元数据泄露                                 │
│  │   └── IAM权限问题                                │
│  ├── GCP配置错误                                    │
│  ├── Azure配置错误                                  │
│  └── Kubernetes配置                                 │
│                                                     │
│  [子域名接管]                                        │
│  ├── CNAME检测                                      │
│  ├── 云服务指纹                                     │
│  └── 自动验证                                       │
│                                                     │
└─────────────────────────────────────────────────────┘
```

### Phase 3: 智能引擎

```
┌─────────────────────────────────────────────────────┐
│                   智能引擎                           │
├─────────────────────────────────────────────────────┤
│                                                     │
│  [自动化调度]                                        │
│  ├── 任务队列管理                                   │
│  ├── 并发控制                                       │
│  ├── 速率限制                                       │
│  ├── 失败重试                                       │
│  └── 断点续扫                                       │
│                                                     │
│  [智能策略]                                          │
│  ├── 目标识别 (根据技术栈选择扫描策略)                │
│  ├── 优先级排序 (高价值目标优先)                     │
│  ├── 去重合并 (智能结果去重)                         │
│  └── 误报过滤 (机器学习减少误报)                     │
│                                                     │
│  [通知系统]                                          │
│  ├── Discord Webhook                                │
│  ├── Telegram Bot                                   │
│  ├── Slack                                          │
│  ├── 邮件通知                                       │
│  └── 自定义Webhook                                  │
│                                                     │
│  [持续监控]                                          │
│  ├── 定时扫描                                       │
│  ├── 变化检测                                       │
│  │   ├── 新子域名                                   │
│  │   ├── 新端口                                     │
│  │   ├── 新技术栈                                   │
│  │   └── 内容变化                                   │
│  └── 增量扫描                                       │
│                                                     │
└─────────────────────────────────────────────────────┘
```

### Phase 4: 报告系统

```
┌─────────────────────────────────────────────────────┐
│                   报告系统                           │
├─────────────────────────────────────────────────────┤
│                                                     │
│  [报告格式]                                          │
│  ├── HTML交互式报告                                 │
│  ├── PDF专业报告                                    │
│  ├── Markdown报告                                   │
│  ├── JSON结构化数据                                 │
│  └── CSV导出                                        │
│                                                     │
│  [报告内容]                                          │
│  ├── 执行摘要                                       │
│  ├── 资产清单                                       │
│  ├── 漏洞详情                                       │
│  │   ├── 严重性评级                                 │
│  │   ├── 复现步骤                                   │
│  │   ├── 请求/响应证据                              │
│  │   ├── 修复建议                                   │
│  │   └── 参考链接                                   │
│  ├── 统计图表                                       │
│  └── 附录                                           │
│                                                     │
│  [平台集成]                                          │
│  ├── HackerOne格式导出                              │
│  ├── Bugcrowd格式导出                               │
│  └── Jira集成                                       │
│                                                     │
└─────────────────────────────────────────────────────┘
```

---

## 技术架构

```
┌─────────────────────────────────────────────────────────────┐
│                        ReconHunter                          │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────────────┐ │
│  │   CLI模式    │  │  Web界面    │  │      API服务        │ │
│  └──────┬──────┘  └──────┬──────┘  └──────────┬──────────┘ │
│         │                │                     │            │
│         └────────────────┼─────────────────────┘            │
│                          ▼                                  │
│  ┌───────────────────────────────────────────────────────┐ │
│  │                    核心引擎 (Go)                       │ │
│  │  ┌─────────┐ ┌─────────┐ ┌─────────┐ ┌─────────────┐  │ │
│  │  │任务调度  │ │并发控制  │ │插件管理  │ │ 结果聚合    │  │ │
│  │  └─────────┘ └─────────┘ └─────────┘ └─────────────┘  │ │
│  └───────────────────────────────────────────────────────┘ │
│                          │                                  │
│         ┌────────────────┼────────────────┐                │
│         ▼                ▼                ▼                │
│  ┌───────────┐   ┌───────────┐   ┌───────────────┐        │
│  │ 资产发现   │   │ 漏洞扫描   │   │ 报告生成       │        │
│  │  模块      │   │   模块     │   │   模块         │        │
│  └───────────┘   └───────────┘   └───────────────┘        │
│                                                             │
│  ┌───────────────────────────────────────────────────────┐ │
│  │                    数据存储层                          │ │
│  │  ┌─────────┐ ┌─────────┐ ┌─────────┐ ┌─────────────┐  │ │
│  │  │ SQLite  │ │  Redis  │ │ 文件存储 │ │  对象存储   │  │ │
│  │  │(默认)   │ │ (可选)   │ │ (报告)  │ │  (截图)     │  │ │
│  │  └─────────┘ └─────────┘ └─────────┘ └─────────────┘  │ │
│  └───────────────────────────────────────────────────────┘ │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

---

## 使用方式

### CLI模式

```bash
# 完整扫描
reconhunter scan -t example.com --full

# 仅信息收集
reconhunter recon -t example.com

# 仅漏洞扫描
reconhunter vuln -l targets.txt

# 持续监控
reconhunter monitor -t example.com --interval 24h

# 指定模块
reconhunter scan -t example.com -m subdomain,portscan,nuclei

# 使用配置文件
reconhunter scan -c config.yaml

# 导出报告
reconhunter report -o report.pdf --format pdf
```

### Web界面

```
http://localhost:8080

功能:
├── Dashboard (实时统计)
├── Targets (目标管理)
├── Scans (扫描任务)
├── Findings (漏洞发现)
├── Assets (资产库)
├── Reports (报告下载)
├── Settings (配置)
└── API Keys (密钥管理)
```

---

## 配置示例

```yaml
# config.yaml
target:
  scope:
    - "*.example.com"
    - "example.org"
  exclude:
    - "admin.example.com"
    - "*.dev.example.com"

modules:
  subdomain:
    enabled: true
    sources:
      - crtsh
      - securitytrails
      - shodan
    bruteforce: true
    wordlist: "wordlists/subdomains-top1m.txt"

  portscan:
    enabled: true
    ports: "top1000"
    rate: 10000

  nuclei:
    enabled: true
    severity:
      - critical
      - high
      - medium
    templates:
      - cves
      - vulnerabilities
      - exposures

concurrency:
  max_goroutines: 100
  rate_limit: 150/s
  timeout: 30s

notify:
  discord:
    webhook: "https://discord.com/api/webhooks/xxx"
    on: ["critical", "high"]
  telegram:
    bot_token: "xxx"
    chat_id: "xxx"

output:
  dir: "./output"
  formats:
    - json
    - html
    - pdf
```

---

## 独特功能 (竞品没有的)

### 1. 智能上下文分析
```
自动识别目标类型，选择最佳扫描策略:
- 电商网站 → 重点扫支付、用户、订单相关
- API服务 → 重点扫认证、IDOR、注入
- WordPress → 加载WordPress专用扫描
- 云服务 → 加载云安全模块
```

### 2. 漏洞链发现
```
自动组合多个低危漏洞成高危漏洞链:
- 开放重定向 + OAuth = 账号接管
- SSRF + 云元数据 = RCE
- XSS + CSRF = 账号接管
```

### 3. 一键复现环境
```
对于发现的漏洞，自动生成:
- curl命令
- Python PoC脚本
- Burp请求文件
- Docker复现环境
```

### 4. 赏金估算
```
根据漏洞类型和目标，估算可能的赏金:
- 基于HackerOne/Bugcrowd历史数据
- 考虑目标公司规模
- 漏洞影响评估
```

### 5. 协作模式
```
团队功能:
- 多人同时扫描不同目标
- 漏洞去重 (避免重复提交)
- 任务分配
- 成果共享
```

---

## 文件结构

```
recon-hunter/
├── cmd/
│   └── reconhunter/
│       └── main.go
├── internal/
│   ├── config/
│   │   └── config.go
│   ├── runner/
│   │   ├── runner.go
│   │   └── scheduler.go
│   ├── modules/
│   │   ├── subdomain/
│   │   ├── portscan/
│   │   ├── httpx/
│   │   ├── nuclei/
│   │   ├── jshunter/
│   │   ├── dirscan/
│   │   ├── paramfuzz/
│   │   └── ...
│   ├── scanner/
│   │   ├── sqli/
│   │   ├── xss/
│   │   ├── ssrf/
│   │   ├── cors/
│   │   └── ...
│   ├── report/
│   │   ├── html.go
│   │   ├── pdf.go
│   │   └── markdown.go
│   ├── notify/
│   │   ├── discord.go
│   │   ├── telegram.go
│   │   └── webhook.go
│   ├── storage/
│   │   ├── sqlite.go
│   │   └── redis.go
│   ├── web/
│   │   ├── server.go
│   │   ├── api/
│   │   └── static/
│   └── utils/
│       ├── http.go
│       ├── dns.go
│       └── common.go
├── pkg/
│   └── types/
├── wordlists/
│   ├── subdomains-top1m.txt
│   ├── directories.txt
│   ├── parameters.txt
│   └── ...
├── templates/
│   ├── report.html
│   └── report.pdf
├── scripts/
│   └── install.sh
├── go.mod
├── go.sum
├── config.example.yaml
├── Dockerfile
├── docker-compose.yml
└── README.md
```

---

## 下一步

开始实现核心框架，从以下顺序进行:

1. 核心框架 (配置、调度、日志)
2. 子域名枚举模块
3. 端口扫描模块
4. Web探测模块
5. 漏洞扫描模块
6. 报告生成
7. Web界面
8. 通知系统
